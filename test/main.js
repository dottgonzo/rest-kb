"use strict";
var index_1 = require("../index");
var chai_1 = require("chai");
var express = require("express");
var app = express();
var switched = "";
app.get('/to/:number', function (req, res) {
    switched = parseInt(req.params.number);
    res.send(req.params.number);
});
app.get('/next', function (req, res) {
    switched = "next";
    res.send('next');
});
app.get('/prev', function (req, res) {
    switched = "prev";
    res.send('prev');
});
app.listen(2121);
var map = [
    {
        key: "c:90",
        path: "/to/0"
    },
    {
        key: "c:87",
        path: "/to/1"
    },
    {
        key: "c:88",
        path: "/to/2"
    },
    {
        key: "c:89",
        path: "/to/3"
    },
    {
        key: "c:83",
        path: "/to/4"
    },
    {
        key: "c:84",
        path: "/to/5"
    },
    {
        key: "c:85",
        path: "/to/6"
    },
    {
        key: "c:79",
        path: "/to/7"
    },
    {
        key: "c:80",
        path: "/to/8"
    },
    {
        key: "c:81",
        path: "/to/9"
    },
    {
        key: "c:86",
        path: "/next"
    },
    {
        key: "c:82",
        path: "/prev"
    },
];
before(function (done) {
    index_1.kbMap(map, { requestradix: "http://localhost:2121" }).then(function (a) {
        chai_1.expect(a).to.be.ok;
        done();
    }).catch(function (err) {
        done(err);
    });
});
describe("test rest-kb with numeric pad", function () {
    it("go to 1", function (done) {
        this.timeout(50000);
        console.log("press 1");
        var wait_forKey = setInterval(function () {
            if (switched === 1) {
                chai_1.expect(switched).to.be.eq(1);
                clearInterval(wait_forKey);
                done();
            }
        }, 500);
    });
    it("go to 2", function (done) {
        this.timeout(50000);
        console.log("press 2");
        var wait_forKey = setInterval(function () {
            if (switched === 2) {
                chai_1.expect(switched).to.be.eq(2);
                clearInterval(wait_forKey);
                done();
            }
        }, 500);
    });
    it("go to 3", function (done) {
        this.timeout(50000);
        console.log("press 3");
        var wait_forKey = setInterval(function () {
            if (switched === 3) {
                chai_1.expect(switched).to.be.eq(3);
                clearInterval(wait_forKey);
                done();
            }
        }, 500);
    });
    it("go to 4", function (done) {
        this.timeout(50000);
        console.log("press 4");
        var wait_forKey = setInterval(function () {
            if (switched === 4) {
                chai_1.expect(switched).to.be.eq(4);
                clearInterval(wait_forKey);
                done();
            }
        }, 500);
    });
    it("go to next", function (done) {
        this.timeout(50000);
        console.log("press +");
        var wait_forKey = setInterval(function () {
            if (switched === "next") {
                chai_1.expect(switched).to.be.eq("next");
                clearInterval(wait_forKey);
                done();
            }
        }, 500);
    });
    it("go to previous", function (done) {
        this.timeout(50000);
        console.log("press -");
        var wait_forKey = setInterval(function () {
            if (switched === "prev") {
                chai_1.expect(switched).to.be.eq("prev");
                clearInterval(wait_forKey);
                done();
            }
        }, 500);
    });
});

//# sourceMappingURL=data:application/json;charset=utf8;base64,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Q0FBQyxDQUFDLENBQUE7SUFFRixFQUFFLENBQUMsZ0JBQWdCLEVBQUUsVUFBVSxJQUFJO1FBQy9CLElBQUksQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLENBQUE7UUFDbkIsT0FBTyxDQUFDLEdBQUcsQ0FBQyxTQUFTLENBQUMsQ0FBQTtRQUd0QixJQUFNLFdBQVcsR0FBRyxXQUFXLENBQUM7WUFDNUIsRUFBRSxDQUFDLENBQUMsUUFBUSxLQUFLLE1BQU0sQ0FBQyxDQUFDLENBQUM7Z0JBQ3RCLGFBQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxNQUFNLENBQUMsQ0FBQTtnQkFDakMsYUFBYSxDQUFDLFdBQVcsQ0FBQyxDQUFBO2dCQUMxQixJQUFJLEVBQUUsQ0FBQTtZQUNWLENBQUM7UUFFTCxDQUFDLEVBQUUsR0FBRyxDQUFDLENBQUE7SUFFWCxDQUFDLENBQUMsQ0FBQTtBQUlOLENBQUMsQ0FBQyxDQUFBIiwiZmlsZSI6InRlc3QvbWFpbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGtiTWFwIH0gZnJvbSBcIi4uL2luZGV4XCJcbmltcG9ydCB7IGV4cGVjdCB9IGZyb20gXCJjaGFpXCJcbmltcG9ydCAqIGFzIGV4cHJlc3MgZnJvbSBcImV4cHJlc3NcIlxuXG5jb25zdCBhcHAgPSBleHByZXNzKClcblxubGV0IHN3aXRjaGVkOiBhbnkgPSBcIlwiXG5cblxuYXBwLmdldCgnL3RvLzpudW1iZXInLCBmdW5jdGlvbiAocmVxLCByZXMpIHtcbiAgICBzd2l0Y2hlZCA9IHBhcnNlSW50KHJlcS5wYXJhbXMubnVtYmVyKVxuICAgIHJlcy5zZW5kKHJlcS5wYXJhbXMubnVtYmVyKTtcbn0pO1xuXG5hcHAuZ2V0KCcvbmV4dCcsIGZ1bmN0aW9uIChyZXEsIHJlcykge1xuICAgIHN3aXRjaGVkID0gXCJuZXh0XCJcbiAgICByZXMuc2VuZCgnbmV4dCcpO1xufSk7XG5cbmFwcC5nZXQoJy9wcmV2JywgZnVuY3Rpb24gKHJlcSwgcmVzKSB7XG4gICAgc3dpdGNoZWQgPSBcInByZXZcIlxuICAgIHJlcy5zZW5kKCdwcmV2Jyk7XG59KTtcblxuYXBwLmxpc3RlbigyMTIxKTtcblxuXG5jb25zdCBtYXAgPSBbXG5cbiAgICB7XG4gICAgICAgIGtleTogXCJjOjkwXCIsXG4gICAgICAgIHBhdGg6IFwiL3RvLzBcIlxuICAgIH0sXG4gICAge1xuICAgICAgICBrZXk6IFwiYzo4N1wiLFxuICAgICAgICBwYXRoOiBcIi90by8xXCJcbiAgICB9LFxuXG4gICAge1xuICAgICAgICBrZXk6IFwiYzo4OFwiLFxuICAgICAgICBwYXRoOiBcIi90by8yXCJcbiAgICB9LFxuXG4gICAge1xuICAgICAgICBrZXk6IFwiYzo4OVwiLFxuICAgICAgICBwYXRoOiBcIi90by8zXCJcbiAgICB9LFxuXG4gICAge1xuICAgICAgICBrZXk6IFwiYzo4M1wiLFxuICAgICAgICBwYXRoOiBcIi90by80XCJcbiAgICB9LFxuXG4gICAge1xuICAgICAgICBrZXk6IFwiYzo4NFwiLFxuICAgICAgICBwYXRoOiBcIi90by81XCJcbiAgICB9LFxuXG4gICAge1xuICAgICAgICBrZXk6IFwiYzo4NVwiLFxuICAgICAgICBwYXRoOiBcIi90by82XCJcbiAgICB9LFxuXG4gICAge1xuICAgICAgICBrZXk6IFwiYzo3OVwiLFxuICAgICAgICBwYXRoOiBcIi90by83XCJcbiAgICB9LFxuXG4gICAge1xuICAgICAgICBrZXk6IFwiYzo4MFwiLFxuICAgICAgICBwYXRoOiBcIi90by84XCJcbiAgICB9LFxuXG4gICAge1xuICAgICAgICBrZXk6IFwiYzo4MVwiLFxuICAgICAgICBwYXRoOiBcIi90by85XCJcbiAgICB9LFxuXG4gICAge1xuICAgICAgICBrZXk6IFwiYzo4NlwiLFxuICAgICAgICBwYXRoOiBcIi9uZXh0XCJcbiAgICB9LFxuXG4gICAge1xuICAgICAgICBrZXk6IFwiYzo4MlwiLFxuICAgICAgICBwYXRoOiBcIi9wcmV2XCJcbiAgICB9LFxuXG5dXG5cblxuXG5cblxuXG5iZWZvcmUoZnVuY3Rpb24gKGRvbmUpIHtcblxuICAgIGtiTWFwKG1hcCwgeyByZXF1ZXN0cmFkaXg6IFwiaHR0cDovL2xvY2FsaG9zdDoyMTIxXCIgfSkudGhlbigoYSkgPT4ge1xuICAgICAgICBleHBlY3QoYSkudG8uYmUub2tcbiAgICAgICAgZG9uZSgpXG4gICAgfSkuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICBkb25lKGVycilcbiAgICB9KVxuXG59KVxuXG5kZXNjcmliZShcInRlc3QgcmVzdC1rYiB3aXRoIG51bWVyaWMgcGFkXCIsIGZ1bmN0aW9uICgpIHtcblxuICAgIGl0KFwiZ28gdG8gMVwiLCBmdW5jdGlvbiAoZG9uZSkge1xuICAgICAgICB0aGlzLnRpbWVvdXQoNTAwMDApXG4gICAgICAgIGNvbnNvbGUubG9nKFwicHJlc3MgMVwiKVxuXG5cbiAgICAgICAgY29uc3Qgd2FpdF9mb3JLZXkgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICAgICAgICBpZiAoc3dpdGNoZWQgPT09IDEpIHtcbiAgICAgICAgICAgICAgICBleHBlY3Qoc3dpdGNoZWQpLnRvLmJlLmVxKDEpXG4gICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh3YWl0X2ZvcktleSlcbiAgICAgICAgICAgICAgICBkb25lKClcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9LCA1MDApXG5cbiAgICB9KVxuXG5cbiAgICBpdChcImdvIHRvIDJcIiwgZnVuY3Rpb24gKGRvbmUpIHtcbiAgICAgICAgdGhpcy50aW1lb3V0KDUwMDAwKVxuICAgICAgICBjb25zb2xlLmxvZyhcInByZXNzIDJcIilcblxuXG4gICAgICAgIGNvbnN0IHdhaXRfZm9yS2V5ID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgICAgICAgaWYgKHN3aXRjaGVkID09PSAyKSB7XG4gICAgICAgICAgICAgICAgZXhwZWN0KHN3aXRjaGVkKS50by5iZS5lcSgyKVxuICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwod2FpdF9mb3JLZXkpXG4gICAgICAgICAgICAgICAgZG9uZSgpXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfSwgNTAwKVxuXG4gICAgfSlcblxuICAgIGl0KFwiZ28gdG8gM1wiLCBmdW5jdGlvbiAoZG9uZSkge1xuICAgICAgICB0aGlzLnRpbWVvdXQoNTAwMDApXG4gICAgICAgIGNvbnNvbGUubG9nKFwicHJlc3MgM1wiKVxuXG5cbiAgICAgICAgY29uc3Qgd2FpdF9mb3JLZXkgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICAgICAgICBpZiAoc3dpdGNoZWQgPT09IDMpIHtcbiAgICAgICAgICAgICAgICBleHBlY3Qoc3dpdGNoZWQpLnRvLmJlLmVxKDMpXG4gICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh3YWl0X2ZvcktleSlcbiAgICAgICAgICAgICAgICBkb25lKClcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9LCA1MDApXG5cbiAgICB9KVxuXG4gICAgaXQoXCJnbyB0byA0XCIsIGZ1bmN0aW9uIChkb25lKSB7XG4gICAgICAgIHRoaXMudGltZW91dCg1MDAwMClcbiAgICAgICAgY29uc29sZS5sb2coXCJwcmVzcyA0XCIpXG5cblxuICAgICAgICBjb25zdCB3YWl0X2ZvcktleSA9IHNldEludGVydmFsKCgpID0+IHtcbiAgICAgICAgICAgIGlmIChzd2l0Y2hlZCA9PT0gNCkge1xuICAgICAgICAgICAgICAgIGV4cGVjdChzd2l0Y2hlZCkudG8uYmUuZXEoNClcbiAgICAgICAgICAgICAgICBjbGVhckludGVydmFsKHdhaXRfZm9yS2V5KVxuICAgICAgICAgICAgICAgIGRvbmUoKVxuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0sIDUwMClcblxuICAgIH0pXG5cblxuICAgIGl0KFwiZ28gdG8gbmV4dFwiLCBmdW5jdGlvbiAoZG9uZSkge1xuICAgICAgICB0aGlzLnRpbWVvdXQoNTAwMDApXG4gICAgICAgIGNvbnNvbGUubG9nKFwicHJlc3MgK1wiKVxuXG5cbiAgICAgICAgY29uc3Qgd2FpdF9mb3JLZXkgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICAgICAgICBpZiAoc3dpdGNoZWQgPT09IFwibmV4dFwiKSB7XG4gICAgICAgICAgICAgICAgZXhwZWN0KHN3aXRjaGVkKS50by5iZS5lcShcIm5leHRcIilcbiAgICAgICAgICAgICAgICBjbGVhckludGVydmFsKHdhaXRfZm9yS2V5KVxuICAgICAgICAgICAgICAgIGRvbmUoKVxuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0sIDUwMClcblxuICAgIH0pXG5cbiAgICBpdChcImdvIHRvIHByZXZpb3VzXCIsIGZ1bmN0aW9uIChkb25lKSB7XG4gICAgICAgIHRoaXMudGltZW91dCg1MDAwMClcbiAgICAgICAgY29uc29sZS5sb2coXCJwcmVzcyAtXCIpXG5cblxuICAgICAgICBjb25zdCB3YWl0X2ZvcktleSA9IHNldEludGVydmFsKCgpID0+IHtcbiAgICAgICAgICAgIGlmIChzd2l0Y2hlZCA9PT0gXCJwcmV2XCIpIHtcbiAgICAgICAgICAgICAgICBleHBlY3Qoc3dpdGNoZWQpLnRvLmJlLmVxKFwicHJldlwiKVxuICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwod2FpdF9mb3JLZXkpXG4gICAgICAgICAgICAgICAgZG9uZSgpXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfSwgNTAwKVxuXG4gICAgfSlcblxuXG5cbn0pIl19
